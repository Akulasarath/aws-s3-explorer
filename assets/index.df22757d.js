import{r as e,w as t,c as o,D as l,o as n,a as i,b as r,d as s,e as a,v as c,u as d,f as u,g as p,h as g,t as y,i as h,j as b,M as f,k as m,F as k,l as w,p as S,m as v,n as C,q as E,s as j}from"./vendor.f4fad2de.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const O=()=>{};O.toString=()=>`[DEBUG ${(new Date).toString()}]`;var x={log:console.log.bind(console,"%s",O)};const D=JSON.parse(localStorage.getItem("s3console")||"{}"),A=e(Object.assign({region:null,delimiter:"/",currentBucket:null,rememberedBuckets:[],currentDirectory:null,applicationClientId:null,applicationLoginUrl:null,identityPoolId:null,objects:[],loggedOut:!1},D,{initialized:!1,showBucketSelector:!1,showSettings:!1,showAddFolder:!1,showTrash:!1,showUploads:!1,deletedObjects:{}}));t(A,(()=>{localStorage.setItem("s3console",JSON.stringify(A)),AWS.config.update({region:A.region})}));const I=o((()=>A.currentBucket));t(I,(()=>{A.deletedObjects={}}));var B=new class{decode(e){try{return e&&JSON.parse(function(e){const t=(e=e.replace(/-/g,"+").replace(/_/g,"/")).length%4;if(t){if(1===t)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");e+=new Array(5-t).join("=")}return atob(e)}(e.split(".")[1]))}catch(t){return null}}};const P=async e=>crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e)),T=async()=>{const e=await P(crypto.getRandomValues(new Uint32Array(4)).toString());return Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")};async function R(){const e=new URL(window.location).searchParams;if(A.initialized=!0,A.tokens&&l.fromSeconds(B.decode(A.tokens.access_token).exp)>l.utc())return await $(),void(A.showSettings=!1);const t=e.get("code");if(null!==t){const e=new URL(window.location);e.searchParams.delete("nonce"),e.searchParams.delete("expires_in"),e.searchParams.delete("access_token"),e.searchParams.delete("id_token"),e.searchParams.delete("state"),e.searchParams.delete("code"),e.searchParams.delete("iss"),window.history.replaceState({},void 0,e.toString());const o=localStorage.getItem("codeVerifier");if(null===o)throw new Error("Unexpected code");const l=Object.entries({grant_type:"authorization_code",client_id:A.applicationClientId,code:t,code_verifier:o,redirect_uri:`${window.location.origin}${window.location.pathname}`}).map((([e,t])=>`${e}=${t}`)).join("&"),n=await fetch(`${A.applicationLoginUrl}/oauth2/token`,{method:"POST",headers:new Headers({"content-type":"application/x-www-form-urlencoded"}),body:l});if(!n.ok)throw new Error(await n.json());const i=await n.json();return A.tokens=i,await $(),void(A.showSettings=!1)}if(!A.applicationLoginUrl||!A.applicationClientId||!A.identityPoolId)return void(A.showSettings=!0);try{new URL(A.applicationLoginUrl)}catch(a){return}const o=await T(),n=await T();localStorage.setItem("codeVerifier",n);const i=(r=await P(n),btoa(String.fromCharCode.apply(null,new Uint8Array(r))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""));var r;const s=`${window.location.origin}${window.location.pathname}`;A.loggedOut=!1,window.location=`${A.applicationLoginUrl}/oauth2/authorize?response_type=code&client_id=${A.applicationClientId}&state=${o}&code_challenge_method=S256&code_challenge=${i}&redirect_uri=${s}`,await $()}async function $(){if(A.identityPoolId&&(A.region=A.identityPoolId.split(":")[0],A.tokens))try{const e=B.decode(A.tokens.id_token).iss.split("/").slice(-1)[0];AWS.config.region=A.region,AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:A.identityPoolId,Logins:{[`cognito-idp.${AWS.config.region}.amazonaws.com/${e}`]:A.tokens.id_token}}),x.log("Checking credentials"),AWS.config.credentials.get((async()=>{const e=await new AWS.STS({region:A.region}).getCallerIdentity().promise();x.log("AWS Credentials Set",e)}))}catch(e){x.log("Failed to set credentials, following requests will not work due to the error:",e)}}const L={class:"modal-dialog"},U={class:"modal-content"},_=r("div",{class:"modal-header"},[r("h4",{class:"modal-title"},"S3 Explorer: Settings")],-1),K={class:"modal-body"},N={class:"col-md-18"},F=r("h2",null,"Welcome to the AWS S3 Explorer",-1),z={class:"",style:{width:"100%"}},M=r("div",null," Specify the Cognito User Pool login url and clientId ",-1),W=u(" Login Domain Url: "),V=r("br",null,null,-1),q=u(" Client ID: "),H=r("br",null,null,-1),Y=u(" Identity Pool ID: "),J=r("br",null,null,-1),G=["disabled"],Q=[r("i",{class:"fas fa-sign-in-alt"},null,-1),u(" Login")],X=p("<hr><div><h4>Setup Cognito SSO Login</h4> Or setup up a cognito pool, cognito identity pool, and configure the explorer. <ol><li> Cognito User Pool: <ul><li>Create a User Pool in any region (Not an identity pool)</li><li>Since we will use SSO, most of the configuration is irrelevant</li><li><strong>General settings &gt; App clients</strong> &gt; Add the S3 Console as an app</li><li><strong>Federation &gt; Identity providers</strong> &gt; Add your SSO provider of choice to the OAuth settings</li><li><strong>App Integration &gt; App client settings</strong> &gt; Enable identity provider just created</li><li>Specify <strong>https://rhosys.github.io/aws-s3-explorer/</strong> as the callback and logout urls</li><li>Specify <strong>Authorization code grant</strong> flow and enable All <strong>Allowed OAuth Scopes</strong></li><li><strong>App Integration &gt; Domain name</strong> &gt; Configure the setup for a domain (either Cognito or your own custom one.</li></ul></li><li> Cognito Identity Pool: <ul><li>Create an identity pool in the same region as the user pool</li><li>Create a role which the pool can assume that has access to the relevant S3 resources.</li><li>Specify the Cognito Pool from the previous step as the Authentication Provider</li></ul></li><li>Return here and enter the Cognito user pool login URL, ID, and identity pool ID above.</li></ol></div>",2),Z={setup(t){e({region:null});return(e,t)=>(n(),i("div",null,[r("div",L,[r("div",U,[r("form",{onSubmit:t[3]||(t[3]=s((e=>(async()=>{R()})()),["prevent"]))},[r("div",null,[_,r("div",K,[r("div",N,[F,r("div",z,[M,r("div",null,[W,a(r("input",{name:"Login Domain URL","onUpdate:modelValue":t[0]||(t[0]=e=>d(A).applicationLoginUrl=e),type:"text",class:"form-control",placeholder:"https://domain.auth.eu-west-1.amazoncognito.com",required:"true",style:{"margin-right":"1rem"}},null,512),[[c,d(A).applicationLoginUrl]]),V,q,a(r("input",{name:"Application Client ID","onUpdate:modelValue":t[1]||(t[1]=e=>d(A).applicationClientId=e),type:"text",class:"form-control",placeholder:"4altoao354oiddqicdifb8tv4mjp",required:"true",style:{"margin-right":"1rem"}},null,512),[[c,d(A).applicationClientId]]),H,Y,a(r("input",{name:"Cognito Identity Pool","onUpdate:modelValue":t[2]||(t[2]=e=>d(A).identityPoolId=e),type:"text",class:"form-control",placeholder:"eu-west-1:3b921bfd-4443-4a62-ba15-000000000000",required:"true",style:{"margin-right":"1rem"}},null,512),[[c,d(A).identityPoolId]]),J,r("button",{type:"submit",class:"btn btn-primary",disabled:!d(A).applicationLoginUrl||!d(A).applicationClientId||!d(A).identityPoolId},Q,8,G)]),X])])])])],32)])])]))}};function ee(e){return e.replace(/^\/+/g,"").replace(/\/+$/g,"")}function te(e){if(!e)return"";const t={0:"B",1:"KB",2:"MB",3:"GB",4:"TB",5:"PB"};let o=e;for(let l=0;l<5;l++){if(o<2048)return`${o} ${t[l]}`;o=Math.floor(o/102.4)/10}return"Too Large"}const oe=o({get:()=>A.currentBucket});async function le(){A.objects=await ne(A.currentDirectory)}async function ne(e){if(!A.currentBucket)return[];const t=new AWS.S3({maxRetries:0,region:A.region}),o={Bucket:A.currentBucket,Delimiter:A.delimiter,Prefix:e?e!==A.delimiter?`${e}/`:e:void 0,RequestPayer:"requester"};let n;for(;o.ContinuationToken||!n;){const e=await t.listObjectsV2(o).promise();n=(n||[]).concat(e.CommonPrefixes.map((e=>({key:e.Prefix.slice(0,-1)||A.delimiter,type:"DIRECTORY"})))).concat(e.Contents.map((e=>({key:e.Key,lastModified:l.fromJSDate(new Date(e.LastModified)).toFormat("DD TTT"),size:e.Size,storageClass:e.StorageClass,type:"PATH"})))),o.ContinuationToken=e.NextContinuationToken}return n}t(oe,(()=>{le()}));const ie={class:"modal-dialog"},re={class:"modal-content"},se={name:"settings_form"},ae=r("div",{class:"modal-header"},[r("h4",{class:"modal-title"},"Select an S3 Bucket")],-1),ce={class:"modal-body"},de={class:"col-md-18"},ue=u("Current Bucket: "),pe=r("br",null,null,-1),ge=r("h4",null,"Select a bucket or specify a new one:",-1),ye=r("small",null,"Enter a bucket",-1),he=u("Search for bucket"),be=r("br",null,null,-1),fe={key:0},me=r("ul",{class:"nav nav-tabs","data-tabs":"tabs"},[r("li",{role:"presentation",class:"active"},[r("a",{href:"#cors","data-toggle":"tab"},"CORS")])],-1),ke={id:"my-tab-content",class:"tab-content"},we={class:"tab-pane active",id:"cors"},Se=r("p",null,"The browser cannot display the contents of this Amazon S3 bucket because it is missing proper cross-origin resource sharing (CORS) configuration.",-1),ve=r("p",null,"To configure CORS, you create a CORS configuration that identifies the origins allowed to access your bucket and the operations (HTTP methods) supported.",-1),Ce=r("p",null,"To do this, go to the Amazon S3 Console, select your bucket in the buckets panel, and click to reveal Permissions in the Properties pane. Click Edit CORS Configuration. The CORS Configuration Editor panel will open up with a field where you can enter a CORS Configuration. Enter a configuration similar to the following:",-1),Ee={key:1},je=r("ul",{class:"nav nav-tabs","data-tabs":"tabs"},[r("li",{role:"presentation",class:"active"},[r("a",{href:"#cors","data-toggle":"tab"},"Access Denied")])],-1),Oe={id:"my-tab-content",class:"tab-content"},xe={class:"tab-pane active",id:"cors"},De=r("p",null,"The role you are using is not configured to allow access to this bucket.",-1),Ae=r("p",null,"To configure permissions, you create a bucket policy configuration that identifies the origins allowed to access your bucket and the operations (HTTP methods) supported.",-1),Ie=r("p",null,"To do this, go to the Amazon S3 Console, select your bucket in the buckets panel, and click to reveal Permissions in the Properties pane. Click Edit CORS Configuration. The CORS Configuration Editor panel will open up with a field where you can enter a CORS Configuration. Enter a configuration similar to the following:",-1),Be={setup(t){const o=e({showCorsError:!1,suggestedCorsConfiguration:[{AllowedHeaders:["*"],AllowedMethods:["PUT","POST","DELETE","HEAD","GET"],AllowedOrigins:["https://rhosys.github.io","https://console.rhosys.ch"],ExposeHeaders:["x-amz-server-side-encryption","x-amz-request-id","x-amz-id-2"],MaxAgeSeconds:3e3}]}),l=e=>{A.rememberedBuckets.push({bucket:e}),A.currentBucket=e,s(e)},s=async(e,t)=>{o.showError=null;try{await async function(e){const t=new AWS.S3({maxRetries:0,region:A.region});try{await t.getBucketCors({Bucket:e}).promise()}catch(o){if(o&&"NetworkingError"===o.code)throw Error("CORS");if(o&&"AccessDenied"===o.code)throw Error("PERMISSIONS");throw o}}(e)}catch(l){if("CORS"===l.message)return void(o.showError="CORS");if("PERMISSIONS"===l.message)return void(o.showError="PERMISSIONS");x.log("Failed to look up information about the bucket",l)}t||(A.showBucketSelector=!1)};return g((async()=>{A.currentBucket&&await s(A.currentBucket,!0)})),(e,t)=>(n(),i("div",null,[r("div",ie,[r("div",re,[r("form",se,[r("div",null,[ae,r("div",ce,[r("div",de,[r("h4",null,[ue,r("strong",null,y(d(A).currentBucket),1)]),pe,ge,h(d(f),{modelValue:d(A).currentBucket,"onUpdate:modelValue":t[0]||(t[0]=e=>d(A).currentBucket=e),options:d(A).rememberedBuckets.map((e=>e.bucket)),placeholder:"Select a bucket or enter a new one",showLabels:!1,allowEmpty:!1,taggable:!0,"open-direction":"bottom",hideSelected:!0,closeOnSelect:!0,selectLabel:"(press enter to select)","tag-placeholder":"(press enter to select)",onTag:l,onSelect:s},{noOptions:b((()=>[ye])),placeholder:b((()=>[he])),_:1},8,["modelValue","options"]),be,"CORS"===d(o).showError?(n(),i("div",fe,[me,r("div",ke,[r("div",we,[Se,ve,Ce,r("p",null,[r("pre",null,y(JSON.stringify(d(o).suggestedCorsConfiguration,null,2)),1)])])])])):"PERMISSIONS"===d(o).showError?(n(),i("div",Ee,[je,r("div",Oe,[r("div",xe,[De,Ae,Ie,r("p",null,[r("pre",null,y(JSON.stringify(d(o).suggestedCorsConfiguration,null,2)),1)])])])])):m("",!0)])])])])])])]))}},Pe={id:"AddFolderModal",tabindex:"-1"},Te={class:"modal-dialog"},Re={class:"modal-content"},$e={class:"modal-header"},Le=r("h4",{class:"modal-title"},"S3 Explorer: Create New Folder",-1),Ue={class:"modal-body"},_e={class:"col-md-18"},Ke={class:"panel panel-default"},Ne={class:"panel-body"},Fe=r("p",null,"Please enter the relative path of the S3 folder to add to the current directory of the selected bucket, for example folder01 or Lorem/Ipsum/Bacon.",-1),ze=u("Current Bucket: "),Me=r("br",null,null,-1),We=r("br",null,null,-1),Ve={class:"input-group bottom-marg-10"},qe={class:"input-group-addon"},He={class:"modal-footer"},Ye={class:"form-group"},Je={class:"col-sm-offset-2 col-sm-10"},Ge=["disabled"],Qe=[r("i",{class:"fa fa-folder-plus fa-lg"},null,-1),u(" Add Folder")],Xe={setup(t){const o=e({newFolderName:null});return(e,t)=>(n(),i("div",Pe,[r("div",Te,[r("div",Re,[r("form",{onSubmit:t[3]||(t[3]=s((e=>{(async()=>{x.log("Adding new directory");const e=o.newFolderName.trim(),t=ee(e),l=ee(`${A.currentDirectory||""}${A.delimiter}${t}`);if(x.log("Calculated directory:",l),A.objects.find((e=>e.key===l&&"DIRECTORY"===e.type)))return void bootbox.alert(`Error: folder or object already exists at: ${l}`);const n=new AWS.S3(AWS.config),i={Bucket:A.currentBucket,Key:`${l}${A.delimiter}`};try{await n.headObject(i).promise(),x.log("Directory already exists, skipping creation")}catch(r){if(!r)return void bootbox.alert(`Error: directory or object already exists at: ${l}`);if(r&&"NotFound"!==r.code)return void bootbox.alert(`Error checking existence of folder: ${r}`);try{await n.putObject(i).promise()}catch(s){return x.log("putObject error:",s),void bootbox.alert(`Error creating folder: ${s}`)}}A.objects.push({key:`${A.currentDirectory}${A.delimiter}${e.split(A.delimiter)[0]}`,type:"DIRECTORY"}),A.showAddFolder=!1})()}),["prevent"]))},[r("div",null,[r("div",$e,[r("button",{type:"button",class:"close",onClick:t[0]||(t[0]=e=>d(A).showAddFolder=!1),"aria-hidden":"true"},"×"),Le]),r("div",Ue,[r("div",_e,[r("div",Ke,[r("div",Ne,[Fe,r("span",null,[ze,r("strong",null,y(d(A).currentBucket),1)]),Me,We,r("div",Ve,[r("span",qe,y(d(A).currentDirectory||"(root)"),1),a(r("input",{name:"folder","onUpdate:modelValue":t[1]||(t[1]=e=>d(o).newFolderName=e),type:"text",class:"form-control",placeholder:"folder",required:"true"},null,512),[[c,d(o).newFolderName]])])])])])]),r("div",He,[r("div",Ye,[r("div",Je,[r("button",{type:"button",class:"btn btn-default",onClick:t[2]||(t[2]=e=>d(A).showAddFolder=!1)},"Cancel"),r("button",{type:"submit",disabled:!d(o).newFolderName,class:"btn btn-primary"},Qe,8,Ge)])])])])],32)])])]))}},Ze={id:"TrashModal",tabindex:"-1"},et={class:"modal-dialog modal-xl"},tt={class:"modal-content"},ot={class:"modal-header"},lt={class:"modal-title"},nt={class:"modal-body"},it={class:"col-md-18"},rt={class:"panel-body"},st=u(" Please confirm that you want to delete the following objects from S3. "),at=r("br",null,null,-1),ct=u("Current Bucket: "),dt=r("br",null,null,-1),ut=r("br",null,null,-1),pt={class:"table table-bordered table-hover table-striped",id:"trash-table"},gt=r("thead",{id:"trash-thead"},[r("tr",null,[r("th"),r("th",null,"Object"),r("th",null,"Last Modified"),r("th",null,"Class"),r("th",null,"Size"),r("th",null,"Result")])],-1),yt={id:"trash-tbody"},ht={key:0,class:"fas fa-folder",style:{"margin-right":"1rem"}},bt={key:0,class:"trasherror"},ft={key:1,class:"trashdeleted"},mt={key:2,class:"trasherror"},kt={key:3},wt={class:"modal-footer"},St={class:"form-group"},vt={class:"col-sm-offset-2 col-sm-10"},Ct=["disabled"],Et=r("i",{class:"fa fa-trash-alt fa-lg"},null,-1),jt={props:{selectedKeys:Array},setup(t){const l=t,s=e({title:null,trashing:!1,objectStatus:{}});g((()=>{A.deletedObjects={}}));const a=o((()=>{var e;const t=null==(e=l.selectedKeys)?void 0:e.reduce(((e,t)=>(e[t]=!0,e)),{});return A.objects.filter((e=>t[e.key])).sort(((e,t)=>e.type===t.type?e.key.localeCompare(t.key):"DIRECTORY"===e.type?-1:1))})),c=o((()=>a.length?`Delete (${a.length})`:"Delete")),p=o((()=>!Object.keys(s.objectStatus).length||!!Object.values(s.objectStatus).find((e=>!e||"DELETED"!==e)))),h=()=>{A.objects=A.objects.filter((e=>!A.deletedObjects[e.key])),A.showTrash=!1},b=async(e,t,o)=>{x.log("Delete file count:",e.length),s.trashing=!0;const l=new AWS.S3({region:A.region}),n=t.reduce(((e,t)=>(e[t.key]=t,e)),{});await Promise.all(e.map((async e=>{if("DELETED"!==s.objectStatus[e]){x.log("Deleting key:",e);try{if("DIRECTORY"!==n[e].type)await l.deleteObject({Bucket:A.currentBucket,Key:e}).promise();else{const t=await ne(e);x.log("Queuing deletes for:",e,t),await b(t.map((e=>e.key)),t,!0)}x.log("DELETED:",e),o||(s.objectStatus[e]="DELETED",A.deletedObjects[e]=!0)}catch(t){if(x.log(`Failed to delete: ${e} - ${t}`),o)throw t;"AccessDenied"===t.code?s.objectStatus[e]="DENIED":s.objectStatus[e]=`Failed: ${t.code}`}}}))),s.trashing=!1};return(e,t)=>(n(),i("div",Ze,[r("div",et,[r("div",tt,[r("div",ot,[r("button",{type:"button",class:"close",onClick:h},"×"),r("h4",lt,"S3 Explorer: Delete "+y(d(s).count)+" objects",1)]),r("div",nt,[r("div",it,[r("div",rt,[r("p",null,[st,at,r("span",null,[ct,r("strong",null,y(d(A).currentBucket),1)]),dt,ut]),r("table",pt,[gt,r("tbody",yt,[(n(!0),i(k,null,w(d(a),((e,t)=>(n(),i("tr",{key:e.key},[r("td",null,y(t+1),1),r("td",null,["DIRECTORY"===e.type?(n(),i("i",ht)):m("",!0),u(y(e.key),1)]),r("td",null,y(e.lastModified),1),r("td",null,y(e.storageClass),1),r("td",null,y(d(te)(e.size)),1),r("td",null,["DENIED"===d(s).objectStatus[e.key]?(n(),i("span",bt,"Access Denied")):"DELETED"===d(s).objectStatus[e.key]?(n(),i("span",ft,"Deleted")):d(s).objectStatus[e.key]?(n(),i("span",mt,y(d(s).objectStatus[e.key]),1)):(n(),i("i",kt))])])))),128))])])])])]),r("div",wt,[r("div",St,[r("div",vt,[r("button",{type:"button",class:"btn btn-default",onClick:h},y(d(p)?"Cancel":"Close"),1),d(s).trashing||d(p)?(n(),i("button",{key:0,type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=e=>b(l.selectedKeys,d(A).objects)),disabled:d(s).trashing},[Et,u(" "+y(d(c)),1)],8,Ct)):m("",!0)])])])])])]))}};S("data-v-5c7707a8");const Ot={class:"fixed-in-bottom-corner"},xt=[r("div",{class:"badge d-flex align-items-center justify-content-center"},[r("div",{class:"d-flex align-items-center justify-content-center"},[r("span",{class:"mr-3 d-none d-sm-block"},[r("i",{class:"fas fa-bolt",style:{color:"gold"}}),u(" Powered By Authress")])])],-1)];v();const Dt={setup(e){const t=()=>{window.open("https://authress.io","_blank")};return(e,o)=>(n(),i("div",Ot,[r("div",{class:"contact-us pointer",onClick:t},xt)]))},__scopeId:"data-v-5c7707a8"};S("data-v-6f824691");const At={class:""},It={class:"col-12"},Bt={class:"panel panel-primary dropzone"},Pt={class:"panel-heading",style:{display:"flex",direction:"row","align-items":"center","justify-content":"space-between"}},Tt={style:{display:"flex",direction:"row","align-items":"center"}},Rt=r("div",{class:"title "},"AWS S3 Explorer",-1),$t={key:0,class:"",style:{"margin-right":"0.5rem"}},Lt={key:1},Ut={key:2},_t={key:0,class:"btn-group"},Kt={id:"badgecount",style:{cursor:"default"},class:"btn badge ",title:"Object count"},Nt={key:1,class:"btn-group"},Ft={id:"badgecount",style:{cursor:"default"},class:"btn badge ",title:"Selected object count"},zt={id:"navbuttons"},Mt={class:"btn-group d-flex"},Wt={key:0},Vt={key:0,style:{cursor:"pointer"},class:"btn fa fa-trash-alt fa-2x",disabled:"",title:"Delete objects"},qt=["title"],Ht={class:"panel-body"},Yt={key:0},Jt=u(" / "),Gt=["href","onClick"],Qt=u(" / "),Xt=r("br",null,null,-1),Zt={class:"table table-bordered table-hover table-striped",style:{width:"100%"},id:"s3objects-table"},eo=r("th",null,"Object",-1),to=r("th",null,"Last Modified",-1),oo=r("th",null,"Class",-1),lo=r("th",null,"Size",-1),no=["onClick"],io=["onUpdate:modelValue"],ro=r("i",{class:"fas fa-folder",style:{"margin-right":"1rem"}},null,-1),so=["href","onClick"],ao=r("td",{style:{"text-align":"center"}},null,-1),co=r("td",{style:{"text-align":"center"}},null,-1),uo=r("td",{style:{"text-align":"center"}},null,-1),po=["onClick"],go=["onUpdate:modelValue"],yo={style:{"text-align":"center"}},ho={style:{"text-align":"center"}},bo={style:{"text-align":"center"}},fo={class:"col-12"};v();const mo={setup(l){const s=e({objectCount:0,selectedKeys:{},globalSelect:!1}),c=()=>{A.showBucketSelector=!0};g((async()=>{if(A.loggedOut)A.showSettings=!0;else if(!A.initialized){await R();try{await le()}catch(e){x.log("Fetching Bucket Objects Error: ",e),A.showBucketSelector=!0}}}));const u=async e=>{s.selectedKeys={},s.globalSelect=!1,A.currentDirectory=e,await le()},p=o((()=>A.objects.sort(((e,t)=>e.key.localeCompare(t.key))))),b=o((()=>Object.keys(s.selectedKeys).filter((e=>!A.deletedObjects[e]&&s.selectedKeys[e])).length)),f=o((()=>A.currentDirectory===A.delimiter?[A.currentDirectory]:A.currentDirectory&&A.currentDirectory.split(A.delimiter)||[]));t(p,(async(e,t)=>{A.currentDirectory&&t.length&&!e.length&&await u(A.currentDirectory.split(A.delimiter).slice(0,-1).join(A.delimiter))}));const S=o((()=>s.globalSelect));return t(S,(e=>{p.value.forEach((t=>{s.selectedKeys[t.key]=e}))})),(e,t)=>(n(),i("div",At,[r("div",It,[r("div",Bt,[r("div",Pt,[r("div",Tt,[Rt,d(A).tokens&&d(A).currentBucket?(n(),i("div",$t,[r("button",{type:"button",class:"btn btn-default",onClick:c},y(d(A).currentBucket),1)])):d(A).tokens?(n(),i("div",Lt,[r("button",{type:"button",class:"btn btn-default",onClick:c},"Select Bucket")])):m("",!0),d(A).tokens&&d(A).currentBucket?(n(),i("div",Ut,[0===d(b)?(n(),i("div",_t,[r("span",Kt,y(d(A).objects.length)+" "+y(d(A).objects.length>1?"objects":"object"),1)])):m("",!0),d(b)>0?(n(),i("div",Nt,[r("span",Ft,y(d(b))+" of "+y(d(A).objects.length)+" selected",1)])):m("",!0)])):m("",!0)]),r("div",zt,[r("div",Mt,[d(A).currentBucket&&d(A).tokens?(n(),i("div",Wt,[r("span",{style:{cursor:"pointer"},class:"btn fa fa-folder-plus fa-2x",onClick:t[0]||(t[0]=e=>d(A).showAddFolder=!0),title:"New folder"}),r("span",{style:{cursor:"pointer"},class:"btn fa fa-cloud-upload-alt fa-2x",onClick:t[1]||(t[1]=e=>d(A).showUploads=!0),title:"Upload files"}),d(b)?(n(),i("span",{key:1,style:{cursor:"pointer"},class:"btn fa fa-trash-alt fa-2x",title:`Delete ${d(b)} selected object(s)`,onClick:t[2]||(t[2]=e=>d(A).showTrash=!0)},null,8,qt)):(n(),i("span",Vt)),r("span",{style:{cursor:"pointer"},class:"btn fa fa-sync fa-2x",onClick:t[3]||(t[3]=e=>(async()=>{try{await le()}catch(e){A.showBucketSelector=!0}})()),title:"Refresh"})])):m("",!0),r("span",{style:{cursor:"pointer"},class:"btn fa fa-sign-out-alt fa-2x",onClick:t[4]||(t[4]=e=>(()=>{if(x.log("Logging out"),A.loggedOut=!0,A.objects=[],A.tokens){A.tokens=null;const e=`${window.location.origin}${window.location.pathname}`;window.location=`${A.applicationLoginUrl}/logout?client_id=${A.applicationClientId}&logout_uri=${e}`}else A.showSettings=!0})()),title:"Settings"})])])]),r("div",Ht,[d(A).tokens&&d(A).currentBucket?(n(),i("div",Yt,[r("div",null,[r("span",null,[r("a",{href:"#",onClick:t[5]||(t[5]=e=>u(null))},y(d(A).currentBucket),1)]),Jt,(n(!0),i(k,null,w(d(f),((e,t)=>(n(),i("span",{key:e},[r("a",{href:`#path=${d(f).slice(0,t+1).join(d(A).delimiter)}`,onClick:e=>u(d(f).slice(0,t+1).join(d(A).delimiter))},y(e),9,Gt),Qt])))),128))])])):m("",!0),Xt,r("table",Zt,[r("thead",null,[r("tr",null,[r("th",{class:"text-center",style:{"text-align":"center",cursor:"pointer"},onClick:t[7]||(t[7]=e=>d(s).globalSelect=!d(s).globalSelect)},[a(r("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>d(s).globalSelect=e)},null,512),[[C,d(s).globalSelect]])]),eo,to,oo,lo])]),r("tbody",null,[(n(!0),i(k,null,w(d(p).filter((e=>"DIRECTORY"===e.type)),(e=>(n(),i("tr",{key:e.key},[r("td",{style:{"text-align":"center",cursor:"pointer"},onClick:()=>d(s).selectedKeys[e.key]=!d(s).selectedKeys[e.key]},[a(r("input",{type:"checkbox","onUpdate:modelValue":t=>d(s).selectedKeys[e.key]=t},null,8,io),[[C,d(s).selectedKeys[e.key]]])],8,no),r("td",null,[ro,r("a",{href:`#path=${e.key}`,onClick:t=>u(e.key)},y(e.key.split(d(A).delimiter).slice(-1)[0]||d(A).delimiter),9,so)]),ao,co,uo])))),128)),(n(!0),i(k,null,w(d(p).filter((e=>"PATH"===e.type)),(e=>(n(),i("tr",{key:e.key},[r("td",{style:{"text-align":"center",cursor:"pointer"},onClick:()=>d(s).selectedKeys[e.key]=!d(s).selectedKeys[e.key]},[a(r("input",{type:"checkbox","onUpdate:modelValue":t=>d(s).selectedKeys[e.key]=t},null,8,go),[[C,d(s).selectedKeys[e.key]]])],8,po),r("td",null,y(e.key.split(d(A).delimiter).slice(-1)[0]||"(marker)"),1),r("td",yo,y(e.lastModified),1),r("td",ho,y(e.storageClass),1),r("td",bo,y(d(te)(e.size)),1)])))),128))])])])])]),r("div",fo,[d(A).showSettings?(n(),E(Z,{key:0})):m("",!0),d(A).showBucketSelector?(n(),E(Be,{key:1})):m("",!0),d(A).showAddFolder?(n(),E(Xe,{key:2})):m("",!0),d(A).showTrash?(n(),E(jt,{key:3,selectedKeys:Object.keys(d(s).selectedKeys).filter((e=>d(s).selectedKeys[e]))},null,8,["selectedKeys"])):m("",!0)]),h(Dt)]))},__scopeId:"data-v-6f824691"};j({setup:e=>(e,t)=>(n(),E(mo))}).mount("#app"),AWS.config.update({region:""}),AWS.config.update({signatureVersion:"v4"});
